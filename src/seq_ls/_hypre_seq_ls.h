/******************************************************************************
 * Copyright (c) 1998 Lawrence Livermore National Security, LLC and other
 * HYPRE Project Developers. See the top-level COPYRIGHT file for details.
 *
 * SPDX-License-Identifier: (Apache-2.0 OR MIT)
 ******************************************************************************/

/*** DO NOT EDIT THIS FILE DIRECTLY (use 'headers' to generate) ***/

#ifndef hypre_SEQ_LS_HEADER
#define hypre_SEQ_LS_HEADER

#include <HYPRE_config.h>
#include "seq_mv.h"

#ifdef __cplusplus
extern "C" {
#endif

#ifndef hypre_DIRECT_SOLVER_DATA_HEADER
#define hypre_DIRECT_SOLVER_DATA_HEADER

/*--------------------------------------------------------------------------
 * hypre_DirectSolverBackend
 *--------------------------------------------------------------------------*/

typedef enum hypre_DirectSolverBackend_enum
{
  HYPRE_DIRECT_SOLVER_VENDOR = 0,
  HYPRE_DIRECT_SOLVER_CUSTOM = 1
} hypre_DirectSolverBackend;

/*--------------------------------------------------------------------------
 * hypre_DirectSolverMethod
 *--------------------------------------------------------------------------*/

typedef enum hypre_DirectSolverMethod_enum
{
  HYPRE_DIRECT_SOLVER_LU    = 0,
  HYPRE_DIRECT_SOLVER_LUPIV = 1,
  HYPRE_DIRECT_SOLVER_CHOL  = 2
} hypre_DirectSolverMethod;

/*--------------------------------------------------------------------------
 * hypre_MatrixType
 *--------------------------------------------------------------------------*/

typedef enum hypre_MatrixType_enum
{
  HYPRE_MATRIX_TYPE_UBATCHED_DENSE  = 0,
  HYPRE_MATRIX_TYPE_VBATCHED_DENSE  = 1,
  HYPRE_MATRIX_TYPE_UBATCHED_SPARSE = 2,
  HYPRE_MATRIX_TYPE_VBATCHED_SPARSE = 3
} hypre_MatrixType;

/*--------------------------------------------------------------------------
 * hypre_DirectSolverData
 *--------------------------------------------------------------------------*/

typedef struct hypre_DirectSolverData_struct
{
   hypre_DirectSolverBackend   backend;
   hypre_DirectSolverMethod    method;
   hypre_MatrixType            mat_type;

   HYPRE_Int                   size;
   HYPRE_Int                  *pivots;
   HYPRE_Int                  *info;
   HYPRE_MemoryLocation        memory_location;
} hypre_DirectSolverData;

/*--------------------------------------------------------------------------
 *  Accessor functions for the hypre_DirectSolverData structure
 *--------------------------------------------------------------------------*/

#define hypre_DirectSolverDataBackend(data)         ((data) -> backend)
#define hypre_DirectSolverDataMethod(data)          ((data) -> method)
#define hypre_DirectSolverDataMatType(data)         ((data) -> mat_type)
#define hypre_DirectSolverDataPivots(data)          ((data) -> pivots)
#define hypre_DirectSolverDataSize(data)            ((data) -> size)
#define hypre_DirectSolverDataInfo(data)            ((data) -> info)
#define hypre_DirectSolverDataMemoryLocation(data)  ((data) -> memory_location)

#endif

/* direct_solver.c */
void* hypre_DirectSolverCreate( hypre_DirectSolverBackend backend, hypre_DirectSolverMethod method,
                                hypre_MatrixType mat_type, HYPRE_Int size,
                                HYPRE_MemoryLocation memory_location );
HYPRE_Int hypre_DirectSolverDestroy( void *vdata );
HYPRE_Int hypre_DirectSolverInitialize( void* vdata );
HYPRE_Int hypre_DirectSolverSetup( void *vdata, void *vA, hypre_Vector *f, hypre_Vector *u );
HYPRE_Int hypre_DirectSolverSolve( void *vdata, void *vA, hypre_Vector *f, hypre_Vector *u );
HYPRE_Int hypre_DirectSolverInvert( void *vdata, void *vA, void **Ainv_ptr );

/* ubatched_direct_vendor.c */
#if defined (HYPRE_USING_CUDA) || defined (HYPRE_USING_HIP)
HYPRE_Int hypre_UBatchedDenseDirectVendorSetup( hypre_DirectSolverData *data,
                                                hypre_UBatchedDenseMatrix *A,
                                                hypre_Vector *f, hypre_Vector *u );
HYPRE_Int hypre_UBatchedDenseDirectVendorSolve( hypre_DirectSolverData *data,
                                                hypre_UBatchedDenseMatrix *A,
                                                hypre_Vector *f, hypre_Vector *u );
HYPRE_Int hypre_UBatchedDenseDirectVendorInvert( hypre_DirectSolverData *data,
                                                 hypre_UBatchedDenseMatrix *A,
                                                 hypre_UBatchedDenseMatrix **Ainv_ptr );
#endif

/* ubatched_direct_custom.c */
HYPRE_Int hypre_UBatchedDenseDirectCustomSetup( hypre_DirectSolverData *data,
                                                hypre_UBatchedDenseMatrix *A,
                                                hypre_Vector *f, hypre_Vector *u );
HYPRE_Int hypre_UBatchedDenseDirectCustomSolve( hypre_DirectSolverData *data,
                                                hypre_UBatchedDenseMatrix *A,
                                                hypre_Vector *f, hypre_Vector *u );
HYPRE_Int hypre_UBatchedDenseDirectCustomInvert( hypre_DirectSolverData *data,
                                                 hypre_UBatchedDenseMatrix *A,
                                                 hypre_UBatchedDenseMatrix **Ainv_ptr );

/* ubatched_direct_magma.c */
#if defined (HYPRE_USING_MAGMA)
void*     hypre_UBatchedDenseDirectMagmaCreate( void );
HYPRE_Int hypre_UBatchedDenseDirectMagmaDestroy( hypre_DirectSolverData *data );
HYPRE_Int hypre_UBatchedDenseDirectMagmaSetup( hypre_DirectSolverData *data,
                                               hypre_UBatchedDenseMatrix *A,
                                               hypre_Vector *f, hypre_Vector *u );
HYPRE_Int hypre_UBatchedDenseDirectMagmaSolve( void *vdata,
                                               hypre_UBatchedDenseMatrix *A,
                                               hypre_Vector *f, hypre_Vector *u );
HYPRE_Int hypre_UBatchedDenseDirectMagmaInvert( void *vdata,
                                                hypre_UBatchedDenseMatrix *A,
                                                hypre_UBatchedDenseMatrix **Ainv_ptr );
#endif

#ifdef __cplusplus
}
#endif

#endif

